%% extender21 - 二维数据扩边/裁剪函数
%
% 功能说明：
%   对二维数据进行边界扩展或裁剪，用于处理模型边界
%
% 输入参数：
%   A    - 输入的二维数组
%   Lz   - 纵向（z方向）扩展/裁剪长度
%   Lx   - 横向（x方向）扩展/裁剪长度
%   flag - 可选参数，1表示裁剪，否则表示扩展
%
% 输出参数：
%   f    - 处理后的二维数组
%

function[f]=extender21(A,Lz,Lx,flag)

% 如果flag=1，执行裁剪操作
if ((nargin>3) && (flag==1))
    % 从扩边后的数据中裁剪出原始大小
    f=A(Lz+1:end-Lz,Lx+1:end-Lx);
else
    % 执行扩边操作
    N=length(A(1,:));
    % 1. 上下扩边：复制第一行和最后一行
    A=[repmat(A(1,:),Lz,1);    % 上边界扩展
       A;                       % 原始数据
       repmat(A(end,:),Lz,1)]; % 下边界扩展
    
    M=length(A(:,1));
    % 2. 左右扩边：复制第一列和最后一列
    f=[repmat(A(:,1),1,Lx)     % 左边界扩展
       A                        % 已经上下扩展的数据
       repmat(A(:,end),1,Lx)]; % 右边界扩展
end

% 扩边操作：
% 原始数据：      扩边后：
% ┌─────┐        ┌───────┐
% │     │        │↑↑↑↑↑↑↑│
% │     │   →    │←     →│
% │     │        │←     →│
% └─────┘        │↓↓↓↓↓↓↓│
%                └───────┘

% 裁剪操作（flag=1）：
% 扩边数据：      裁剪后：
% ┌───────┐      ┌─────┐
% │↑↑↑↑↑↑↑│      │     │
% │←     →│  →   │     │
% │←     →│      │     │
% │↓↓↓↓↓↓↓│      └─────┘
% └───────┘